"""
–ö–†–û–ö 2: –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –±–æ—Ç–∞ —á–µ—Ä–µ–∑ .env —Ñ–∞–π–ª

–©–æ —Ç–∞–∫–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è?
- –¶–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —è–∫—ñ –º–æ–∂—É—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—å (—Ç–æ–∫–µ–Ω–∏, URL, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏)
- –ù–µ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤ –∫–æ–¥—ñ (–Ω–µ–±–µ–∑–ø–µ—á–Ω–æ!)
- –ó–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ .env —Ñ–∞–π–ª—ñ

–©–æ —Ç–∞–∫–µ .env —Ñ–∞–π–ª?
- –¢–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –∑ –ø–∞—Ä–∞–º–∏ –∫–ª—é—á=–∑–Ω–∞—á–µ–Ω–Ω—è
- –ù–ï –≤ Git (—â–æ–± –Ω–µ –∑–ª–∏—Ç–∏ —Ç–æ–∫–µ–Ω–∏)
- –ö–æ–∂–µ–Ω —Ä–æ–∑—Ä–æ–±–Ω–∏–∫ –º–∞—î —Å–≤—ñ–π .env

–ü—Ä–∏–∫–ª–∞–¥ .env:
    BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
    DEBUG=True
    LOG_LEVEL=INFO

–©–æ —Ç–∞–∫–µ Pydantic Settings?
- –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è —ñ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–∏—Ç–∞—î –∑ .env
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö
- –î–∞—î –∑—Ä–æ–∑—É–º—ñ–ª—ñ –ø–æ–º–∏–ª–∫–∏
"""

from pathlib import Path
from pydantic_settings import BaseSettings, SettingsConfigDict

# ========================================
# –í–ò–ó–ù–ê–ß–ê–Ñ–ú–û –ö–û–†–Ü–ù–¨ –ü–†–û–ï–ö–¢–£
# ========================================
# __file__ - —Ü–µ —à–ª—è—Ö –¥–æ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (bot/config.py)
# .parent - —Ü–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è bot/
# .parent.parent - —Ü–µ –∫–æ—Ä—ñ–Ω—å –ø—Ä–æ–µ–∫—Ç—É (–¥–µ .env)
PROJECT_ROOT = Path(__file__).parent.parent


# ========================================
# –ö–õ–ê–° –ù–ê–õ–ê–®–¢–£–í–ê–ù–¨
# ========================================
class Settings(BaseSettings):
    """
    –ö–ª–∞—Å –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ –±–æ—Ç–∞

    –ù–∞—Å–ª—ñ–¥—É—î—Ç—å—Å—è –≤—ñ–¥ BaseSettings –∑ Pydantic
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–∏—Ç–∞—î –∑–º—ñ–Ω–Ω—ñ –∑ .env —Ñ–∞–π–ª—É

    –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:
    1. –í–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –æ–±'—î–∫—Ç: settings = Settings()
    2. Pydantic —à—É–∫–∞—î .env —Ñ–∞–π–ª
    3. –ß–∏—Ç–∞—î BOT_TOKEN –∑ .env
    4. –ü–µ—Ä–µ–≤—ñ—Ä—è—î —â–æ —Ü–µ string (str)
    5. –Ø–∫—â–æ –Ω–µ–º–∞—î - –ø–æ–º–∏–ª–∫–∞!
    """

    # ========================================
    # –û–ë–û–í'–Ø–ó–ö–û–í–Ü –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø
    # ========================================

    BOT_TOKEN: str
    """
    –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ –≤—ñ–¥ @BotFather

    –¢–∏–ø: str (string, —Ç–µ–∫—Å—Ç)
    –û–±–æ–≤'—è–∑–∫–æ–≤–∏–π: —Ç–∞–∫ (–Ω–µ–º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)

    –Ø–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞—Ç–∏ BOT_TOKEN –≤ .env - –±—É–¥–µ –ø–æ–º–∏–ª–∫–∞:
    "Field required [type=missing, input_value={}, input_type=dict]"

    –ü—Ä–∏–∫–ª–∞–¥ –≤ .env:
        BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
    """

    # ========================================
    # –û–ü–¶–Ü–û–ù–ê–õ–¨–ù–Ü –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø (–º–∞—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
    # ========================================

    DEBUG: bool = False
    """
    –†–µ–∂–∏–º –≤—ñ–¥–ª–∞–¥–∫–∏ (debug mode)

    –¢–∏–ø: bool (True/False)
    –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: False

    –Ø–∫—â–æ True:
    - –ë—ñ–ª—å—à–µ –ª–æ–≥—ñ–≤
    - –î–µ—Ç–∞–ª—å–Ω—ñ –ø–æ–º–∏–ª–∫–∏
    - –ù–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!

    –ü—Ä–∏–∫–ª–∞–¥ –≤ .env:
        DEBUG=True
    """

    LOG_LEVEL: str = "INFO"
    """
    –†—ñ–≤–µ–Ω—å –ª–æ–≥—É–≤–∞–Ω–Ω—è

    –¢–∏–ø: str
    –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: "INFO"

    –ú–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:
    - "DEBUG" - –≤—Å—ñ –ª–æ–≥–∏ (–±–∞–≥–∞—Ç–æ)
    - "INFO" - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ (–Ω–æ—Ä–º–∞)
    - "WARNING" - –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è
    - "ERROR" - —Ç—ñ–ª—å–∫–∏ –ø–æ–º–∏–ª–∫–∏

    –ü—Ä–∏–∫–ª–∞–¥ –≤ .env:
        LOG_LEVEL=DEBUG
    """

    LOG_TO_FILE: bool = True
    """
    –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –ª–æ–≥–∏ —É —Ñ–∞–π–ª (–ö–†–û–ö 3)

    –¢–∏–ø: bool (True/False)
    –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: True

    –Ø–∫—â–æ True:
    - –õ–æ–≥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ logs/bot.log
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —Ä–æ—Ç–∞—Ü—ñ—è (–Ω–æ–≤–∏–π —Ñ–∞–π–ª –∫–æ–∂–Ω—ñ 10 MB)
    - –ó–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è 1 —Ç–∏–∂–¥–µ–Ω—å
    - –°—Ç–∏—Å–∫–∞—é—Ç—å—Å—è –≤ zip

    –Ø–∫—â–æ False:
    - –õ–æ–≥–∏ —Ç—ñ–ª—å–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ (–Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è)

    –ü—Ä–∏–∫–ª–∞–¥ –≤ .env:
        LOG_TO_FILE=True
    """

    # ========================================
    # –ö–û–ù–§–Ü–ì–£–†–ê–¶–Ü–Ø PYDANTIC
    # ========================================

    model_config = SettingsConfigDict(
        # –ó–≤—ñ–¥–∫–∏ —á–∏—Ç–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ
        # –í–ê–ñ–õ–ò–í–û: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∞–±—Å–æ–ª—é—Ç–Ω–∏–π —à–ª—è—Ö –¥–æ .env
        # –¶–µ –ø—Ä–∞—Ü—é—î –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, –∑–≤—ñ–¥–∫–∏ –∑–∞–ø—É—â–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç
        env_file=str(PROJECT_ROOT / ".env"),  # /home/user/ferm-bot/.env
        env_file_encoding="utf-8",            # –ö–æ–¥—É–≤–∞–Ω–Ω—è UTF-8 (–¥–ª—è –∫–∏—Ä–∏–ª–∏—Ü—ñ)

        # –©–æ —Ä–æ–±–∏—Ç–∏ –∑ –∑–∞–π–≤–∏–º–∏ –ø–æ–ª—è–º–∏ –≤ .env
        extra="ignore",               # –Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ (–Ω–µ –ø–∞–¥–∞—Ç–∏ –∑ –ø–æ–º–∏–ª–∫–æ—é)

        # –ß—É—Ç–ª–∏–≤—ñ—Å—Ç—å –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É
        case_sensitive=False          # BOT_TOKEN = bot_token = Bot_Token
    )


# ========================================
# –°–¢–í–û–†–ï–ù–ù–Ø –û–ë'–Ñ–ö–¢–ê –ù–ê–õ–ê–®–¢–£–í–ê–ù–¨
# ========================================
# –¶–µ –≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è –û–î–†–ê–ó–£ –ø—Ä–∏ —ñ–º–ø–æ—Ä—Ç—ñ –º–æ–¥—É–ª—è
# Python –ø—Ä–æ—á–∏—Ç–∞—î .env —Ñ–∞–π–ª —ñ —Å—Ç–≤–æ—Ä–∏—Ç—å –æ–±'—î–∫—Ç settings

try:
    settings = Settings()
    # –Ø–∫—â–æ –≤—Å–µ –û–ö - settings –º—ñ—Å—Ç–∏—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑ .env

except Exception as e:
    # –Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–µ–º–∞—î .env –∞–±–æ BOT_TOKEN)
    print("‚ùå –ü–û–ú–ò–õ–ö–ê –ö–û–ù–§–Ü–ì–£–†–ê–¶–Ü–á!")
    print(f"   {e}")
    print()
    print("üí° –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:")
    print("   1. –ù–µ–º–∞—î —Ñ–∞–π–ª—É .env –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É")
    print("   2. –í .env –Ω–µ–º–∞—î BOT_TOKEN")
    print("   3. .env —Ñ–∞–π–ª –ø–æ—Ä–æ–∂–Ω—ñ–π –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–æ–≤–Ω–µ–Ω–∏–π")
    print()
    print("üîß –Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:")
    print(f"   1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ .env —Ñ–∞–π–ª —ñ—Å–Ω—É—î: {PROJECT_ROOT / '.env'}")
    print(f"   2. –°—Ç–≤–æ—Ä—ñ—Ç—å –∑ –ø—Ä–∏–∫–ª–∞–¥—É: cp {PROJECT_ROOT / '.env.example'} {PROJECT_ROOT / '.env'}")
    print("   3. –î–æ–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω: BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–≤—ñ–¥_BotFather")
    print()
    print("üìç .env —Ñ–∞–π–ª –º–∞—î –±—É—Ç–∏ —Ç—É—Ç:")
    print(f"   {PROJECT_ROOT / '.env'}")
    print()
    raise  # –ü–µ—Ä–µ–¥–∞—î–º–æ –ø–æ–º–∏–ª–∫—É –¥–∞–ª—ñ (–∑—É–ø–∏–Ω—è—î –ø—Ä–æ–≥—Ä–∞–º—É)


# ========================================
# –Ø–ö –í–ò–ö–û–†–ò–°–¢–û–í–£–í–ê–¢–ò
# ========================================
"""
–í —ñ–Ω—à–∏—Ö —Ñ–∞–π–ª–∞—Ö —ñ–º–ø–æ—Ä—Ç—É–π—Ç–µ settings:

    from bot.config import settings

    # –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–∫–µ–Ω
    token = settings.BOT_TOKEN

    # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∂–∏–º
    if settings.DEBUG:
        print("–†–µ–∂–∏–º –≤—ñ–¥–ª–∞–¥–∫–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π")

    # –û—Ç—Ä–∏–º–∞—Ç–∏ —Ä—ñ–≤–µ–Ω—å –ª–æ–≥—ñ–≤
    log_level = settings.LOG_LEVEL

–ü–µ—Ä–µ–≤–∞–≥–∏:
‚úÖ –¢–æ–∫–µ–Ω–∏ –Ω–µ –≤ –∫–æ–¥—ñ (–±–µ–∑–ø–µ–∫–∞!)
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∏–ø—ñ–≤
‚úÖ –ó—Ä–æ–∑—É–º—ñ–ª—ñ –ø–æ–º–∏–ª–∫–∏
‚úÖ –õ–µ–≥–∫–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
‚úÖ –†—ñ–∑–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è dev/prod
"""
